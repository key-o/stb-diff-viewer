<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>STB Diff Viewer</title>
    <link rel="stylesheet" href="./style/style.css" />
    <!-- è¦ç´ æƒ…å ±ãƒ‘ãƒãƒ«ç”¨ã®ã‚¹ã‚¿ã‚¤ãƒ« -->
    <style>
      #component-info {
        position: absolute; /* çµ¶å¯¾ä½ç½®æŒ‡å®š */
        top: 10px; /* ä¸Šã‹ã‚‰ã®è·é›¢ */
        left: 10px; /* å·¦ã‹ã‚‰ã®è·é›¢ */
        background-color: rgba(240, 240, 240, 0.85); /* åŠé€æ˜ã®èƒŒæ™¯ */
        border: 1px solid #ccc;
        padding: 10px;
        min-width: 300px;
        min-height: 100px;
        width: 30vw;
        max-width: 70vw;
        max-height: 80vh;
        overflow: auto;
        resize: both;
        z-index: 10; /* ä»–ã®è¦ç´ ã‚ˆã‚Šæ‰‹å‰ã«è¡¨ç¤º */
        border-radius: 4px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        font-size: 0.9em;
        color: #333;
      }
      #component-info h3 {
        margin-top: 0;
        margin-bottom: 8px;
        font-size: 1.1em;
        color: #111;
      }
      #component-info pre {
        margin: 0;
        white-space: pre-wrap; /* æŠ˜ã‚Šè¿”ã—è¡¨ç¤º */
        word-wrap: break-word;
      }
      #element-info-content {
        margin-top: 0;
      }
      /* å‡¡ä¾‹ãƒ‘ãƒãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« */
      #legendPanel {
        position: fixed; /* ç”»é¢ã«å¯¾ã—ã¦å›ºå®š */
        bottom: 10px; /* ç”»é¢ä¸‹ã‹ã‚‰ã®è·é›¢ */
        left: 10px; /* ç”»é¢å·¦ã‹ã‚‰ã®è·é›¢ */
        background-color: rgba(
          240,
          240,
          240,
          0.85
        ); /* èƒŒæ™¯è‰² (component-infoã¨åˆã‚ã›ã‚‹) */
        border: 1px solid #ccc; /* å¢ƒç•Œç·š (component-infoã¨åˆã‚ã›ã‚‹) */
        padding: 10px; /* ãƒ‘ãƒ‡ã‚£ãƒ³ã‚° (component-infoã¨åˆã‚ã›ã‚‹) */
        min-width: 150px; /* æœ€å°å¹… */
        max-width: 300px; /* æœ€å¤§å¹…ã‚’ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆåŸºæº–ã« */
        z-index: 10; /* é‡ãªã‚Šé †åº (component-infoã¨åŒã˜) */
        border-radius: 4px; /* è§’ä¸¸ (component-infoã¨åˆã‚ã›ã‚‹) */
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2); /* å½± (component-infoã¨åˆã‚ã›ã‚‹) */
        /* display: none; ã¯HTMLè¦ç´ ã®styleå±æ€§ã§åˆ¶å¾¡ã•ã‚Œã‚‹ãŸã‚ã€ã“ã“ã§ã¯ä¸è¦ */
      }
      /* â˜…â˜…â˜… ã“ã“ã¾ã§è¿½åŠ  â˜…â˜…â˜… */

      /* â˜…â˜…â˜… ç·¨é›†æ©Ÿèƒ½ç”¨ã‚¹ã‚¿ã‚¤ãƒ« â˜…â˜…â˜… */
      .btn {
        padding: 4px 8px;
        margin: 2px;
        border: 1px solid #ccc;
        border-radius: 3px;
        background-color: #f8f9fa;
        cursor: pointer;
        font-size: 0.8em;
      }
      .btn-primary {
        background-color: #007bff;
        color: white;
        border-color: #007bff;
      }
      .btn-warning {
        background-color: #ffc107;
        color: #212529;
        border-color: #ffc107;
      }
      .btn-success {
        background-color: #28a745;
        color: white;
        border-color: #28a745;
      }
      .btn-danger {
        background-color: #dc3545;
        color: white;
        border-color: #dc3545;
      }
      .btn-sm {
        padding: 2px 6px;
        font-size: 0.7em;
      }
      .edit-btn {
        background: none;
        border: none;
        cursor: pointer;
        font-size: 0.8em;
        margin-left: 5px;
        padding: 1px 3px;
        border-radius: 2px;
        opacity: 0.7;
      }
      .edit-btn:hover {
        opacity: 1;
        background-color: #e9ecef;
      }
      #editing-controls {
        background-color: #f8f9fa;
        padding: 8px;
        border-radius: 4px;
        border: 1px solid #dee2e6;
        margin-bottom: 10px;
      }
      /* â˜…â˜…â˜… ç·¨é›†æ©Ÿèƒ½ç”¨ã‚¹ã‚¿ã‚¤ãƒ«çµ‚äº† â˜…â˜…â˜… */

      /* â˜…â˜…â˜… è‰²åˆ†ã‘UIç”¨ã‚¹ã‚¿ã‚¤ãƒ« â˜…â˜…â˜… */
      #color-mode-controls {
        background-color: #f8f9fa;
        padding: 8px;
        border-radius: 4px;
        border: 1px solid #dee2e6;
      }
      .form-control {
        width: 100%;
        padding: 4px 8px;
        border: 1px solid #ced4da;
        border-radius: 3px;
        font-size: 0.9em;
      }
      .color-legend-container {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-top: 5px;
      }
      .legend-item {
        display: flex;
        align-items: center;
        font-size: 0.75em;
      }
      .legend-color-box {
        width: 24px;
        height: 24px;
        border: 2px solid #555;
        margin-right: 8px;
        display: inline-block;
        border-radius: 4px;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }
      .legend-color-box:hover {
        border-color: #333;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
      }
      .legend-label {
        white-space: nowrap;
        font-weight: 500;
        color: #333;
      }
      /* è‰²ä»˜ã‘ãƒ¢ãƒ¼ãƒ‰ç”¨è¿½åŠ ã‚¹ã‚¿ã‚¤ãƒ« */
      .element-color-settings {
        display: none;
        margin-top: 10px;
        padding: 10px;
        background-color: #f8f9fa;
        border-radius: 6px;
        border: 1px solid #e9ecef;
      }
      .schema-color-settings {
        display: none;
        margin-top: 10px;
        padding: 10px;
        background-color: #f8f9fa;
        border-radius: 6px;
        border: 1px solid #e9ecef;
      }
      .importance-color-settings {
        display: none;
        margin-top: 10px;
        padding: 10px;
        background-color: #f8f9fa;
        border-radius: 6px;
        border: 1px solid #e9ecef;
      }
      .color-setting-label {
        font-size: 1em;
        font-weight: 600;
        color: #495057;
        margin-bottom: 8px;
        display: block;
      }
      .legend-item {
        display: flex;
        align-items: center;
        font-size: 0.85em;
        margin-bottom: 8px;
        padding: 4px;
        border-radius: 4px;
        transition: background-color 0.2s;
      }
      .legend-item:hover {
        background-color: rgba(0, 0, 0, 0.05);
      }
      /* è‰²ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã®æ”¹å–„ */
      .color-preview {
        width: 16px;
        height: 16px;
        border-radius: 50%;
        border: 2px solid #fff;
        box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.2);
        margin-left: 8px;
        display: inline-block;
      }
      .color-setting-help {
        font-size: 0.8em;
        color: #666;
        margin-bottom: 8px;
        font-style: italic;
      }
      .margin-left-8 {
        margin-left: 8px;
      }
      .legend-panel-hidden {
        display: none;
      }
      .legend-color-matched {
        background-color: #00aaff;
      }
      .legend-color-onlya {
        background-color: #00ff00;
      }
      .legend-color-onlyb {
        background-color: #ff0000;
      }
      .editing-summary {
        margin-top: 8px;
        font-size: 0.9em;
      }
      .legend-color {
        width: 12px;
        height: 12px;
        border: 1px solid #ccc;
        margin-right: 4px;
        display: inline-block;
      }
      /* â˜…â˜…â˜… è‰²åˆ†ã‘UIç”¨ã‚¹ã‚¿ã‚¤ãƒ«ã“ã“ã¾ã§ â˜…â˜…â˜… */

      /* â˜…â˜…â˜… ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã‚¹ã‚¿ã‚¤ãƒ« â˜…â˜…â˜… */
      .accordion-section {
        border: 1px solid #dee2e6;
        border-radius: 6px;
        margin-bottom: 8px;
        background: #fff;
        overflow: hidden;
      }

      .accordion-header {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        border-bottom: 1px solid #dee2e6;
        padding: 12px 15px;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-weight: 600;
        color: #495057;
        transition: all 0.2s ease;
        user-select: none;
      }

      .accordion-header:hover {
        background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
        color: #212529;
      }

      .accordion-header span:first-child {
        display: flex;
        align-items: center;
        font-size: 0.95em;
      }

      .accordion-arrow {
        font-size: 0.8em;
        transition: transform 0.3s ease;
        color: #6c757d;
      }

      .accordion-header.collapsed .accordion-arrow {
        transform: rotate(-90deg);
      }

      .accordion-content {
        padding: 15px;
        background: #fff;
        transition: all 0.3s ease;
        max-height: 1000px;
        overflow: hidden;
      }

      .accordion-content.collapsed {
        max-height: 0;
        padding-top: 0;
        padding-bottom: 0;
        opacity: 0;
      }

      /* ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³å†…ã®è¦ç´ ã®èª¿æ•´ */
      .accordion-content hr {
        margin: 15px 0;
        border: none;
        border-top: 1px solid #dee2e6;
      }

      .accordion-content label {
        margin-bottom: 8px;
        font-size: 0.9em;
      }

      .accordion-content select,
      .accordion-content input[type="file"],
      .accordion-content button {
        margin-bottom: 10px;
      }

      .accordion-content button {
        font-size: 0.85em;
        padding: 8px 12px;
      }

      /* åˆæœŸè¡¨ç¤ºã§é–‹ã„ã¦ã„ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®èª¿æ•´ */
      .accordion-section:first-child .accordion-content,
      .accordion-section:nth-child(2) .accordion-content,
      .accordion-section:nth-child(3) .accordion-content {
        /* ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã€è¡¨ç¤ºè¨­å®šã€è¦ç´ è¡¨ç¤ºè¨­å®šã¯åˆæœŸè¡¨ç¤ºã§é–‹ã */
      }
      /* â˜…â˜…â˜… ã‚¢ã‚³ãƒ¼ãƒ‡ã‚£ã‚ªãƒ³ã‚¹ã‚¿ã‚¤ãƒ«çµ‚äº† â˜…â˜…â˜… */

      /* â˜…â˜…â˜… å·®åˆ†æ¯”è¼ƒUIç”¨ã‚¹ã‚¿ã‚¤ãƒ« â˜…â˜…â˜… */
      .diff-comparison-intro p {
        font-size: 0.9em;
        color: #666;
        margin: 0 0 10px 0;
      }

      .btn-primary.compare-button {
        background: #007bff;
        color: white;
        border: none;
        padding: 10px 15px;
        border-radius: 5px;
        font-weight: bold;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      .btn-primary.compare-button:hover {
        background: #0056b3;
      }

      #diff-summary {
        display: none;
        margin-top: 15px;
        padding: 10px;
        background: #f8f9fa;
        border-radius: 5px;
        border-left: 4px solid #007bff;
      }

      .diff-summary-title {
        font-weight: bold;
        margin-bottom: 8px;
        color: #495057;
      }

      #diff-summary-content {
        font-size: 0.9em;
        color: #666;
      }

      .diff-stat-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 4px;
        padding: 2px 0;
      }

      .diff-stat-value {
        font-weight: 600;
        color: #495057;
      }

      .diff-stat-matched {
        color: #007bff;
      }

      .diff-stat-only-a {
        color: #28a745;
      }

      .diff-stat-only-b {
        color: #dc3545;
      }
      .diff-mode-description {
        font-size: 0.9em;
        color: #666;
        margin-bottom: 8px;
      }

      .legend-description {
        font-size: 0.9em;
        color: #666;
      }

      /* â˜…â˜…â˜… å·®åˆ†æ¯”è¼ƒUIç”¨ã‚¹ã‚¿ã‚¤ãƒ«çµ‚äº† â˜…â˜…â˜… */

      /* â˜…â˜…â˜… ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°ç¯„å›²èª¿æ•´ã‚¹ã‚¿ã‚¤ãƒ« â˜…â˜…â˜… */
      .clipping-group {
        margin-bottom: 20px;
      }

      .clip-range-controls {
        margin-top: 10px;
        padding: 12px;
        background: #f8f9fa;
        border-radius: 6px;
        border: 1px solid #e9ecef;
        animation: slideDown 0.3s ease;
      }

      @keyframes slideDown {
        from {
          opacity: 0;
          max-height: 0;
          padding-top: 0;
          padding-bottom: 0;
        }
        to {
          opacity: 1;
          max-height: 100px;
          padding-top: 12px;
          padding-bottom: 12px;
        }
      }

      .range-control-group {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .range-control-group label {
        font-size: 0.85em;
        font-weight: 600;
        color: #495057;
        margin-bottom: 4px;
      }

      .range-slider-container {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .range-label {
        font-size: 0.75em;
        color: #6c757d;
        white-space: nowrap;
        min-width: 30px;
        text-align: center;
      }

      .clip-range-slider {
        flex: 1;
        height: 6px;
        background: #dee2e6;
        border-radius: 3px;
        outline: none;
        -webkit-appearance: none;
        appearance: none;
      }

      .clip-range-slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 18px;
        height: 18px;
        background: #007bff;
        border-radius: 50%;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        transition: all 0.2s ease;
      }

      .clip-range-slider::-webkit-slider-thumb:hover {
        background: #0056b3;
        transform: scale(1.1);
      }

      .clip-range-slider::-moz-range-thumb {
        width: 18px;
        height: 18px;
        background: #007bff;
        border-radius: 50%;
        cursor: pointer;
        border: none;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        transition: all 0.2s ease;
      }

      .clip-range-slider::-moz-range-thumb:hover {
        background: #0056b3;
        transform: scale(1.1);
      }

      .range-value-display {
        text-align: center;
        font-size: 0.9em;
        font-weight: 600;
        color: #495057;
        background: #fff;
        padding: 4px 8px;
        border-radius: 4px;
        border: 1px solid #dee2e6;
        min-width: 60px;
      }

      .clip-apply-btn {
        background: #28a745;
        color: white;
        border: none;
        padding: 6px 12px;
        border-radius: 4px;
        font-size: 0.85em;
        cursor: pointer;
        transition: background-color 0.2s ease;
        margin-top: 5px;
      }

      .clip-apply-btn:hover {
        background: #218838;
      }

      .clip-apply-btn:active {
        background: #1e7e34;
      }

      .clear-clip-btn {
        background: #dc3545;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        font-size: 0.85em;
        cursor: pointer;
        transition: background-color 0.2s ease;
      }

      .clear-clip-btn:hover {
        background: #c82333;
      }

      .preview-clip-btn {
        background: #17a2b8;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        font-size: 0.85em;
        cursor: pointer;
        transition: background-color 0.2s ease;
        margin-left: 8px;
      }

      .preview-clip-btn:hover {
        background: #138496;
      }

      .clipping-controls {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-top: 10px;
      }

      /* ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°çŠ¶æ…‹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */
      .clipping-active {
        border-left: 4px solid #28a745;
        background: linear-gradient(135deg, #f8fff9 0%, #f1f9f1 100%);
      }

      .clipping-group.active .clip-apply-btn {
        background: #ffc107;
        color: #212529;
      }

      .clipping-group.active .clip-apply-btn:hover {
        background: #e0a800;
      }
      /* â˜…â˜…â˜… ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°ç¯„å›²èª¿æ•´ã‚¹ã‚¿ã‚¤ãƒ«çµ‚äº† â˜…â˜…â˜… */
    </style>
  </head>
  <body>
    <div id="overlay">
      <!-- ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div class="accordion-section">
        <div class="accordion-header" data-target="file-loading">
          <span>ğŸ“Š ãƒ¢ãƒ‡ãƒ«å·®åˆ†æ¯”è¼ƒ</span>
          <span class="accordion-arrow">â–¼</span>
        </div>
        <div class="accordion-content" id="file-loading">
          <div class="diff-comparison-intro">
            <p>2ã¤ã®STBãƒ¢ãƒ‡ãƒ«ã‚’æ¯”è¼ƒã—ã¦å·®åˆ†ã‚’ç¢ºèªã—ã¾ã™</p>
          </div>
          <label for="fileA"><strong>æ¯”è¼ƒå…ƒãƒ¢ãƒ‡ãƒ« (A)</strong></label>
          <input type="file" id="fileA" accept=".stb,.xml" />
          <label for="fileB"><strong>æ¯”è¼ƒå…ˆãƒ¢ãƒ‡ãƒ« (B)</strong></label>
          <input type="file" id="fileB" accept=".stb,.xml" />
          <button id="compareButton" class="btn-primary compare-button">
            ğŸ” å·®åˆ†æ¯”è¼ƒã‚’å®Ÿè¡Œ
          </button>

          <!-- å·®åˆ†çµæœã‚µãƒãƒªãƒ¼è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
          <div id="diff-summary">
            <div class="diff-summary-title">ğŸ“ˆ å·®åˆ†ã‚µãƒãƒªãƒ¼</div>
            <div id="diff-summary-content">
              <!-- å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹å·®åˆ†çµ±è¨ˆ -->
            </div>
          </div>
        </div>
      </div>

      <!-- è¡¨ç¤ºè¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div class="accordion-section">
        <div class="accordion-header" data-target="display-settings">
          <span>ğŸ¨ å·®åˆ†è¡¨ç¤ºè¨­å®š</span>
          <span class="accordion-arrow">â–¼</span>
        </div>
        <div class="accordion-content" id="display-settings">
          <!-- è‰²ä»˜ã‘ãƒ¢ãƒ¼ãƒ‰é¸æŠUI -->
          <div id="color-mode-controls">
            <label><strong>è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰</strong></label>
            <div class="diff-mode-description">
              å·®åˆ†ç¢ºèªã«ã¯ã€Œå·®åˆ†è¡¨ç¤ºã€ã‚’æ¨å¥¨ã—ã¾ã™
            </div>
            <select
              id="colorModeSelector"
              class="form-control"
              title="è‰²ä»˜ã‘ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠ"
            >
              <option value="diff">ğŸ” å·®åˆ†è¡¨ç¤ºï¼ˆæ¨å¥¨ï¼‰</option>
              <option value="element">ğŸ—ï¸ éƒ¨æåˆ¥è‰²ä»˜ã‘</option>
              <option value="schema">âš ï¸ ã‚¹ã‚­ãƒ¼ãƒã‚¨ãƒ©ãƒ¼è¡¨ç¤º</option>
              <option value="importance">ğŸ·ï¸ é‡è¦åº¦åˆ¥è‰²ä»˜ã‘</option>
            </select>

            <!-- è‰²ä»˜ã‘ãƒ¢ãƒ¼ãƒ‰çŠ¶æ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
            <div id="color-mode-status" class="color-mode-status hidden">
              <span id="color-mode-status-text"></span>
            </div>

            <!-- éƒ¨æåˆ¥è‰²ä»˜ã‘è¨­å®š -->
            <div id="element-color-settings" class="element-color-settings">
              <label class="color-setting-label">éƒ¨æè‰²è¨­å®š:</label>
              <div class="color-setting-help">
                â€» è‰²ãƒœãƒƒã‚¯ã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å„éƒ¨æã®è¡¨ç¤ºè‰²ã‚’å¤‰æ›´ã§ãã¾ã™
              </div>
              <div class="color-legend-container" id="element-color-controls">
                <!-- å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ -->
              </div>
            </div>

            <!-- ã‚¹ã‚­ãƒ¼ãƒã‚¨ãƒ©ãƒ¼è‰²è¨­å®š -->
            <div id="schema-color-settings" class="schema-color-settings">
              <label class="color-setting-label">ã‚¹ã‚­ãƒ¼ãƒã‚¨ãƒ©ãƒ¼è‰²è¨­å®š:</label>
              <div class="color-setting-help">
                â€» ã‚¹ã‚­ãƒ¼ãƒæ¤œè¨¼ã®çµæœã«å¿œã˜ã¦è¦ç´ ã«è‰²ä»˜ã‘ã—ã¾ã™
              </div>
              <div class="color-legend-container">
                <div class="legend-item">
                  <input
                    type="color"
                    id="schema-valid-color"
                    value="#00aaff"
                    class="legend-color-box"
                    title="æ­£å¸¸è¦ç´ ã®è‰²ã‚’å¤‰æ›´"
                  />
                  <span class="legend-label">æ­£å¸¸è¦ç´ </span>
                  <span
                    class="color-preview"
                    id="schema-valid-preview"
                    title="ç¾åœ¨ã®è‰²: #00aaff"
                  ></span>
                </div>
                <div class="legend-item">
                  <input
                    type="color"
                    id="schema-error-color"
                    value="#ff0000"
                    class="legend-color-box"
                    title="ã‚¨ãƒ©ãƒ¼è¦ç´ ã®è‰²ã‚’å¤‰æ›´"
                  />
                  <span class="legend-label">ã‚¨ãƒ©ãƒ¼è¦ç´ </span>
                  <span
                    class="color-preview"
                    id="schema-error-preview"
                    title="ç¾åœ¨ã®è‰²: #ff0000"
                  ></span>
                </div>
              </div>
            </div>

            <!-- é‡è¦åº¦è‰²è¨­å®š -->
            <div
              id="importance-color-settings"
              class="importance-color-settings"
            >
              <label class="color-setting-label">é‡è¦åº¦è‰²è¨­å®š:</label>
              <div class="color-setting-help">
                â€» å„é‡è¦åº¦ãƒ¬ãƒ™ãƒ«ã®è¡¨ç¤ºè‰²ã‚’å¤‰æ›´ã§ãã¾ã™
              </div>
              <div
                class="color-legend-container"
                id="importance-color-controls"
              >
                <!-- å‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ -->
              </div>
            </div>
          </div>

          <hr style="margin: 15px 0" />

          <!-- ãƒ©ãƒ™ãƒ«è¡¨ç¤ºå†…å®¹è¨­å®š -->
          <div id="label-content-controls">
            <label><strong>ãƒ©ãƒ™ãƒ«è¡¨ç¤ºå†…å®¹</strong></label
            ><br />
            <select
              id="labelContentSelector"
              class="form-control"
              title="ãƒ©ãƒ™ãƒ«ã«è¡¨ç¤ºã™ã‚‹å†…å®¹ã‚’é¸æŠ"
            >
              <option value="id">IDï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰</option>
              <option value="name">ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åï¼ˆNameï¼‰</option>
              <option value="section">æ–­é¢åï¼ˆSectionï¼‰</option>
            </select>
          </div>
        </div>
      </div>

      <!-- è¦ç´ è¡¨ç¤ºè¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div class="accordion-section">
        <div class="accordion-header" data-target="element-settings">
          <span>ğŸ—ï¸ è¦ç´ è¡¨ç¤ºè¨­å®š</span>
          <span class="accordion-arrow">â–¼</span>
        </div>
        <div class="accordion-content" id="element-settings">
          <div id="elementSelector">
            <label><strong>ãƒ¢ãƒ‡ãƒ«è¡¨ç¤º</strong></label>
            <label>
              <input
                type="checkbox"
                id="toggleModelA"
                name="modelVisibility"
                value="A"
                checked
              />
              ãƒ¢ãƒ‡ãƒ«Aã‚’è¡¨ç¤º
            </label>
            <br />
            <label>
              <input
                type="checkbox"
                id="toggleModelB"
                name="modelVisibility"
                value="B"
                checked
              />
              ãƒ¢ãƒ‡ãƒ«Bã‚’è¡¨ç¤º
            </label>

            <hr style="margin: 15px 0" />

            <label><strong>æ¯”è¼ƒ/è¡¨ç¤ºã™ã‚‹è¦ç´ </strong></label>
            <label>
              <input
                type="checkbox"
                name="elements"
                value="Node"
                id="toggleNodeView"
                checked
              />
              ç¯€ç‚¹ (Node)
            </label>
            <label for="toggleLabel-Node">
              <input
                type="checkbox"
                name="labelToggle"
                value="Node"
                id="toggleLabel-Node"
              />
              ID
            </label>
            <br />
            <label>
              <input type="checkbox" name="elements" value="Column" checked />
              æŸ± (Column)
            </label>
            <label for="toggleColumnView" class="margin-left-8">
              <input
                type="checkbox"
                id="toggleColumnView"
                name="columnViewMode"
              />
              ç«‹ä½“è¡¨ç¤º
            </label>
            <label for="toggleLabel-Column" class="margin-left-8">
              <input
                type="checkbox"
                name="labelToggle"
                value="Column"
                id="toggleLabel-Column"
              />
              ID
            </label>
            <br />
            <label>
              <input type="checkbox" name="elements" value="Girder" checked />
              å¤§æ¢ (Girder)
            </label>
            <label for="toggleGirderView" class="margin-left-8">
              <input
                type="checkbox"
                id="toggleGirderView"
                name="girderViewMode"
              />
              ç«‹ä½“è¡¨ç¤º
            </label>
            <label for="toggleLabel-Girder" class="margin-left-8">
              <input
                type="checkbox"
                name="labelToggle"
                value="Girder"
                id="toggleLabel-Girder"
              />
              ID
            </label>
            <br />
            <label>
              <input type="checkbox" name="elements" value="Beam" checked />
              å°æ¢ (Beam)
            </label>
            <label for="toggleLabel-Beam">
              <input
                type="checkbox"
                name="labelToggle"
                value="Beam"
                id="toggleLabel-Beam"
              />
              ID
            </label>
            <br />
            <label>
              <input
                type="checkbox"
                name="elements"
                value="Brace"
                id="toggleBraceView"
                checked
              />
              ãƒ–ãƒ¬ãƒ¼ã‚¹ (Brace)
            </label>
            <label for="toggleLabel-Brace">
              <input
                type="checkbox"
                name="labelToggle"
                value="Brace"
                id="toggleLabel-Brace"
              />
              ID
            </label>
            <br />
            <label>
              <input
                type="checkbox"
                name="elements"
                value="Slab"
                id="toggleSlabView"
                checked
              />
              ã‚¹ãƒ©ãƒ– (Slab)
            </label>
            <label for="toggleLabel-Slab">
              <input
                type="checkbox"
                name="labelToggle"
                value="Slab"
                id="toggleLabel-Slab"
              />
              ID
            </label>
            <br />
            <label>
              <input
                type="checkbox"
                name="elements"
                value="Wall"
                id="toggleWallView"
                checked
              />
              å£ (Wall)
            </label>
            <label for="toggleLabel-Wall">
              <input
                type="checkbox"
                name="labelToggle"
                value="Wall"
                id="toggleLabel-Wall"
              />
              ID
            </label>
            <br />
            <label>
              <input
                type="checkbox"
                name="elements"
                value="Axis"
                id="toggleAxisView"
                checked
              />
              é€šã‚ŠèŠ¯ (Axis)
            </label>
            <label for="toggleLabel-Axis">
              <input
                type="checkbox"
                name="labelToggle"
                value="Axis"
                id="toggleLabel-Axis"
                checked
              />
              åç§°
            </label>
            <br />
            <label>
              <input
                type="checkbox"
                name="elements"
                value="Story"
                id="toggleStoryView"
                checked
              />
              éš (Story)
            </label>
            <label for="toggleLabel-Story">
              <input
                type="checkbox"
                name="labelToggle"
                value="Story"
                id="toggleLabel-Story"
                checked
              />
              åç§°/é«˜ã•
            </label>
          </div>
        </div>
      </div>

      <!-- ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°è¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div class="accordion-section">
        <div class="accordion-header" data-target="clipping-settings">
          <span>âœ‚ï¸ ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°è¨­å®š</span>
          <span class="accordion-arrow">â–¼</span>
        </div>
        <div class="accordion-content collapsed" id="clipping-settings">
          <!-- éšã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°è¨­å®š -->
          <div class="clipping-group">
            <label for="storySelector"><strong>éšã®è¡¨ç¤ºåˆ¶é™</strong></label>
            <select id="storySelector"></select>
            <button id="applyStoryClipButton" class="clip-apply-btn">
              ã“ã®éšã§ã‚¯ãƒªãƒƒãƒ—
            </button>

            <!-- éšã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°ç¯„å›²èª¿æ•´ -->
            <div
              id="storyClipControls"
              class="clip-range-controls"
              style="display: none"
            >
              <div class="range-control-group">
                <label for="storyClipRange">ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°ç¯„å›²:</label>
                <div class="range-slider-container">
                  <span class="range-label">ç‹­ã„</span>
                  <input
                    type="range"
                    id="storyClipRange"
                    min="500"
                    max="5000"
                    value="1000"
                    step="100"
                    class="clip-range-slider"
                  />
                  <span class="range-label">åºƒã„</span>
                </div>
                <div class="range-value-display">
                  Â±<span id="storyRangeValue">1.0</span>m
                </div>
              </div>
            </div>
          </div>

          <hr style="margin: 15px 0" />

          <!-- Xè»¸ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°è¨­å®š -->
          <div class="clipping-group">
            <label for="xAxisSelector"><strong>Xè»¸é¸æŠ</strong></label>
            <select id="xAxisSelector"></select>
            <button id="applyXAxisClipButton" class="clip-apply-btn">
              Xè»¸ã§ã‚¯ãƒªãƒƒãƒ—
            </button>

            <!-- Xè»¸ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°ç¯„å›²èª¿æ•´ -->
            <div
              id="xAxisClipControls"
              class="clip-range-controls"
              style="display: none"
            >
              <div class="range-control-group">
                <label for="xAxisClipRange">ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°ç¯„å›²:</label>
                <div class="range-slider-container">
                  <span class="range-label">ç‹­ã„</span>
                  <input
                    type="range"
                    id="xAxisClipRange"
                    min="500"
                    max="10000"
                    value="2000"
                    step="250"
                    class="clip-range-slider"
                  />
                  <span class="range-label">åºƒã„</span>
                </div>
                <div class="range-value-display">
                  Â±<span id="xAxisRangeValue">2.0</span>m
                </div>
              </div>
            </div>
          </div>

          <hr style="margin: 15px 0" />

          <!-- Yè»¸ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°è¨­å®š -->
          <div class="clipping-group">
            <label for="yAxisSelector"><strong>Yè»¸é¸æŠ</strong></label>
            <select id="yAxisSelector"></select>
            <button id="applyYAxisClipButton" class="clip-apply-btn">
              Yè»¸ã§ã‚¯ãƒªãƒƒãƒ—
            </button>

            <!-- Yè»¸ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°ç¯„å›²èª¿æ•´ -->
            <div
              id="yAxisClipControls"
              class="clip-range-controls"
              style="display: none"
            >
              <div class="range-control-group">
                <label for="yAxisClipRange">ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°ç¯„å›²:</label>
                <div class="range-slider-container">
                  <span class="range-label">ç‹­ã„</span>
                  <input
                    type="range"
                    id="yAxisClipRange"
                    min="500"
                    max="10000"
                    value="2000"
                    step="250"
                    class="clip-range-slider"
                  />
                  <span class="range-label">åºƒã„</span>
                </div>
                <div class="range-value-display">
                  Â±<span id="yAxisRangeValue">2.0</span>m
                </div>
              </div>
            </div>
          </div>

          <hr style="margin: 15px 0" />

          <!-- ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°åˆ¶å¾¡ãƒœã‚¿ãƒ³ -->
          <div class="clipping-controls">
            <button id="clearClipButton" class="clear-clip-btn">
              ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°è§£é™¤
            </button>
            <button
              id="previewClipButton"
              class="preview-clip-btn"
              style="display: none"
            >
              ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º
            </button>
          </div>
        </div>
      </div>

      <!-- é‡è¦åº¦è¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div class="accordion-section">
        <div class="accordion-header" data-target="importance-settings">
          <span>ğŸ·ï¸ é‡è¦åº¦è¨­å®š</span>
          <span class="accordion-arrow">â–¼</span>
        </div>
        <div class="accordion-content collapsed" id="importance-settings">
          <button id="toggleImportanceBtn">é‡è¦åº¦ãƒ‘ãƒãƒ«è¡¨ç¤º</button>
          <button onclick="window.toggleImportanceStatistics()">
            çµ±è¨ˆè¡¨ç¤º
          </button>
          <button onclick="window.toggleBulkOperations()">ä¸€æ‹¬æ“ä½œ</button>
          <button onclick="window.toggleImportanceFilter()">
            ãƒ•ã‚£ãƒ«ã‚¿åˆ‡æ›¿
          </button>
        </div>
      </div>

      <!-- ãã®ä»–è¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
      <div class="accordion-section">
        <div class="accordion-header" data-target="other-settings">
          <span>âš™ï¸ ãã®ä»–è¨­å®š</span>
          <span class="accordion-arrow">â–¼</span>
        </div>
        <div class="accordion-content collapsed" id="other-settings">
          <button id="toggleLegendBtn">ğŸ” å·®åˆ†å‡¡ä¾‹ãƒ»æ“ä½œæ–¹æ³•ã‚’è¡¨ç¤º</button>
        </div>
      </div>
    </div>

    <!-- ã“ã“ã«å‡¡ä¾‹ãƒ‘ãƒãƒ«ã®HTMLã‚’è¿½åŠ  -->
    <div id="legendPanel" class="panel legend-panel-hidden">
      <!-- åˆæœŸçŠ¶æ…‹ã¯éè¡¨ç¤º -->
      <div class="panel-header">ğŸ” å·®åˆ†æ¯”è¼ƒå‡¡ä¾‹</div>
      <div class="legend-content">
        <div class="legend-item">
          <span class="legend-color legend-color-matched"></span>
          <span><strong>ä¸€è‡´è¦ç´ </strong></span>
        </div>
        <div class="legend-item">
          <span class="legend-color legend-color-onlya"></span>
          <span><strong>ãƒ¢ãƒ‡ãƒ«Aå°‚ç”¨</strong></span>
        </div>
        <div class="legend-item">
          <span class="legend-color legend-color-onlyb"></span>
          <span><strong>ãƒ¢ãƒ‡ãƒ«Bå°‚ç”¨</strong></span>
        </div>
        <hr />
        <div class="legend-item">
          <span class="legend-description">
            è‰²åˆ†ã‘ã§å·®åˆ†ã‚’ç›´æ„Ÿçš„ã«ç¢ºèªã§ãã¾ã™
          </span>
        </div>
        <hr />
        <div class="legend-item">
          <span><b>æ“ä½œæ–¹æ³•:</b></span>
        </div>
        <div class="legend-item">
          <span>å›è»¢: å·¦ãƒ‰ãƒ©ãƒƒã‚°</span>
        </div>
        <div class="legend-item">
          <span>å¹³è¡Œç§»å‹•: å³ãƒ‰ãƒ©ãƒƒã‚°</span>
        </div>
        <div class="legend-item">
          <span>ã‚ºãƒ¼ãƒ : ãƒ›ã‚¤ãƒ¼ãƒ«</span>
        </div>
      </div>
    </div>
    <!-- /å‡¡ä¾‹ãƒ‘ãƒãƒ« -->

    <!-- â˜…â˜…â˜… è¿½åŠ : è¦ç´ æƒ…å ±è¡¨ç¤ºãƒ‘ãƒãƒ« â˜…â˜…â˜… -->
    <div id="component-info" class="panel info-panel">
      <!-- ç·¨é›†æ©Ÿèƒ½UI (æœ€å°åŒ–) -->
      <div
        id="editing-controls"
        style="font-size: 0.8em; opacity: 0.7; margin-bottom: 8px"
      >
        <button
          id="edit-mode-button"
          class="btn btn-sm"
          style="
            font-size: 0.7em;
            padding: 2px 6px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            color: #6c757d;
          "
          onclick="window.toggleEditMode()"
          title="é«˜åº¦ãªç·¨é›†æ©Ÿèƒ½ï¼ˆé–‹ç™ºè€…å‘ã‘ï¼‰"
        >
          ç·¨é›†
        </button>
        <span
          id="editing-summary"
          style="font-size: 0.7em; color: #6c757d; margin-left: 5px"
        >
          ä¿®æ­£: 0ä»¶
        </span>
      </div>
      <div id="element-info-content">è¦ç´ ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</div>
    </div>
    <!-- /è¦ç´ æƒ…å ±è¡¨ç¤ºãƒ‘ãƒãƒ« -->

    <canvas id="three-canvas"></canvas>

    <!-- é–‹ç™ºè€…å‘ã‘ãƒªãƒ³ã‚¯ (æœ¬ç•ªç’°å¢ƒã§ã¯å‰Šé™¤) -->
    <div
      id="dev-tools"
      style="
        position: fixed;
        bottom: 10px;
        right: 10px;
        z-index: 1000;
        display: none;
      "
    >
      <a
        href="test.html"
        style="
          background: #666;
          color: white;
          padding: 4px 8px;
          text-decoration: none;
          border-radius: 3px;
          font-size: 11px;
          opacity: 0.7;
        "
        title="é–‹ç™ºè€…å‘ã‘ãƒ†ã‚¹ãƒˆç’°å¢ƒ"
      >
        ğŸ§ª Tests
      </a>
    </div>

    <!-- é–‹ç™ºç’°å¢ƒã§ã®ã¿ãƒ†ã‚¹ãƒˆãƒªãƒ³ã‚¯ã‚’è¡¨ç¤º -->
    <script>
      if (
        window.location.hostname === "localhost" ||
        window.location.hostname === "127.0.0.1" ||
        window.location.search.includes("dev=true")
      ) {
        document.getElementById("dev-tools").style.display = "block";
      }
    </script>

    <!-- â˜…â˜…â˜… é–‹ç™ºç”¨ãƒ†ã‚¹ãƒˆãƒ˜ãƒ«ãƒ‘ãƒ¼ â˜…â˜…â˜… -->
    <script type="module" src="test/browser-test-helper.js"></script>
    <script type="module" src="test/axisStoryWireframeTest.js"></script>

    <!-- â˜…â˜…â˜… ãƒ‘ã‚¹ã‚’ js/main.js ã«å¤‰æ›´ â˜…â˜…â˜… -->
    <script type="module" src="js/main.js"></script>

    <!-- â˜…â˜…â˜… è¿½åŠ : selectComponentInfo.js ã® script ã‚¿ã‚°ã¯ä¸è¦ (main.js ã‹ã‚‰ import ã•ã‚Œã‚‹ãŸã‚) â˜…â˜…â˜… -->
    <!-- <script type="module" src="selectComponentInfo.js"></script> -->
  </body>
</html>

/* Reset default styles and basic setup */
html {
  font-size: 16px; /* rem基準値 */
}

html,
body {
  margin: 0;
  padding: 0;
  height: 100%; /* Ensure body takes full height */
  overflow: hidden; /* Prevent body scrollbars */
  font-family: var(--font-family-base);
  font-size: var(--font-size-base);
}

/* フォーム要素のフォント継承リセット */
button, input, select, textarea {
  font-family: inherit;
  font-size: inherit;
}

body {
  display: flex; /* Enable flex layout for body */
  height: 100vh; /* Ensure body takes full viewport height */
  flex-direction: row-reverse; /* ★★★ 追加: 要素の並び順を反転 ★★★ */
  background-color: var(--bg-body);
  color: var(--text-primary);
  transition: background-color var(--transition-base), color var(--transition-base);
}

#overlay {
  width: 300px; /* Fixed width for the control panel */
  padding: 15px;
  box-sizing: border-box; /* Include padding in width calculation */
  height: 100%; /* Make panel take full height of the flex container (body) */
  overflow-y: auto; /* Add scrollbar if content exceeds height */
  background-color: var(--bg-panel); /* Light background for the panel */
  border-left: var(--border-width) solid var(--border-color); /* 左に境界線を追加 */
  flex-shrink: 0; /* Prevent panel from shrinking */
}

#three-canvas {
  flex-grow: 1; /* Allow canvas to take the remaining width */
  height: 100%; /* Make canvas take full height */
  display: block; /* Ensure canvas behaves correctly */
  /* デバッグ用: 明示的に幅を指定し、最小幅を0にすることでflexでの折り返し問題を回避 */
  width: 100%;
  min-width: 0;
  background-color: var(--bg-canvas);
  outline: 2px dashed rgba(255,255,255,0.08);
  position: relative; /* キャンバス要素の絶対配置用 */
  overflow: hidden;
}

/* #legendPanel は panels.css で定義 */

/* Optional: Improve spacing within the overlay panel */
#overlay label,
#overlay input[type="file"],
#overlay select,
#overlay button {
  display: block; /* Make controls block elements */
  width: calc(100% - 10px); /* Adjust width slightly for padding */
  margin-bottom: 10px; /* Add space below controls */
}

#overlay input[type="checkbox"] {
  display: inline-block; /* Keep checkboxes inline */
  width: auto; /* Reset width for checkboxes */
  margin-right: 5px;
  margin-bottom: 0; /* Reset bottom margin */
}
#overlay #elementSelector label {
  margin-bottom: 5px; /* Smaller margin for element toggles */
}

/* 表示要素設定テーブル */
.element-settings-table {
  width: 100%;
  border-collapse: collapse;
  font-size: var(--font-size-md);
  margin-top: 8px;
  margin-bottom: 8px;
}

.element-settings-table th,
.element-settings-table td {
  padding: 6px 8px;
  text-align: center;
  border-bottom: 1px solid var(--border-color);
}

.element-settings-table th {
  background-color: var(--bg-secondary);
  font-weight: var(--font-weight-semibold);
  font-size: var(--font-size-sm);
  white-space: nowrap;
}

.element-settings-table td:first-child {
  text-align: left;
  white-space: nowrap;
}

.element-settings-table tbody tr:hover {
  background-color: var(--bg-hover, rgba(0, 0, 0, 0.05));
}

.element-settings-table input[type="checkbox"] {
  margin: 0;
  cursor: pointer;
}

/* ライン専用表示インジケータ（Undefined要素等） */
.line-only-indicator {
  display: inline-block;
  color: var(--text-muted, #888);
  font-size: var(--font-size-lg);
  text-align: center;
  cursor: help;
}

/* 表示要素テーブル内の色ボックス */
.element-color-input {
  width: var(--color-picker-size);
  height: var(--color-picker-size);
  padding: 0;
  border: var(--color-picker-border-width) solid var(--color-picker-border-color);
  border-radius: var(--border-radius);
  cursor: pointer;
  vertical-align: middle;
}

.element-color-input:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

/* デフォルト色リセットボタンコンテナ */
.element-color-reset-container {
  margin-top: 10px;
  text-align: right;
}

.element-color-reset-container .btn-reset {
  font-size: var(--font-size-sm);
  padding: 4px 12px;
  background-color: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: var(--border-radius);
  cursor: pointer;
}

.element-color-reset-container .btn-reset:hover:not(:disabled) {
  background-color: var(--bg-hover);
}

.element-color-reset-container .btn-reset:disabled {
  opacity: 0.4;
  cursor: not-allowed;
}

#overlay hr {
  margin-top: 15px;
  margin-bottom: 15px;
}

#overlay #storyButtons button {
  display: inline-block; /* Keep story buttons side-by-side */
  width: auto; /* Reset width */
  margin-right: 5px;
}

label {
  display: block;
  margin-bottom: 10px;
}

/* ========================================
   サイドバー内ボタン（統一スタイル）
   ======================================== */

/* サイドバー内のトグルボタン共通スタイル（ウィンドウを開くボタン） */
#overlay > button[id^="toggle-"] {
  display: block;
  width: 100%;
  padding: 12px var(--spacing-md);
  margin: 0;
  margin-bottom: var(--spacing-sm);
  background: var(--sidebar-btn-bg);
  border: var(--border-width) solid var(--sidebar-btn-border);
  border-radius: var(--border-radius-lg);
  color: var(--sidebar-btn-text);
  font-weight: var(--font-weight-medium);
  font-size: var(--font-size-base);
  cursor: pointer;
  transition: all var(--transition-fast);
  text-align: left;
}

#overlay > button[id^="toggle-"]:hover {
  background: var(--sidebar-btn-hover-bg);
  border-color: var(--color-primary-light);
}

/* 一般的なボタン（フォールバック） */
button {
  background-color: var(--color-primary);
  color: var(--text-white);
  border: none;
  padding: var(--btn-padding-y-lg) var(--btn-padding-x-lg);
  border-radius: var(--border-radius);
  cursor: pointer;
  margin-top: 10px;
}

button:hover {
  background-color: var(--color-primary-hover);
}

.panel {
  margin-top: var(--spacing-lg);
  padding: 10px;
  border: var(--border-width) solid var(--border-color);
  border-radius: var(--border-radius);
  background-color: var(--bg-body);
}

.panel-header {
  font-weight: var(--font-weight-bold);
  margin-bottom: 10px;
}

.legend-content {
  display: flex;
  flex-direction: column;
}

/* .legend-item と .legend-color は color-modes.css で定義 */

canvas {
  width: 100%;
  height: 400px;
  border: 1px solid #ccc;
  margin-top: 20px;
}

.comparison-table td.differs {
  background-color: #fff3cd; /* 比較結果: 値が異なるセル */
  font-weight: var(--font-weight-bold);
}

.info-table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 1em;
}
.info-table th,
.info-table td {
  border: var(--border-width) solid var(--border-color-light);
  padding: var(--spacing-sm);
  text-align: left;
  vertical-align: top;
}
.info-table th {
  background-color: var(--accordion-header-bg);
}
#component-info h4 {
  margin-top: 1em;
  margin-bottom: 0.5em;
}

/* 色付けモード状況表示 */
.color-mode-status {
  margin-top: var(--spacing-sm);
  padding: var(--btn-padding-y) 10px;
  border-radius: var(--border-radius);
  font-size: var(--font-size-sm);
  background-color: rgba(74, 111, 165, 0.1);
  border: var(--border-width) solid rgba(74, 111, 165, 0.3);
  color: var(--color-primary);
  text-align: center;
}

.color-mode-status.hidden {
  display: none;
}
